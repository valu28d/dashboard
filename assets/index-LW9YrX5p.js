import{c as R,A as S,S as A}from"./loadSts-CMF7UdVc.js";import{n as _,b as H,e as M,f as U,g as j,h as N,d as z,C as B,o as F,E as V,u as G,I as J,s as Q,i as X,t as Y,j as Z,p as O,M as ee,q as te,P as ne,k as oe,l as se,r as ie,R as re,a as ae,m as ce,T as le}from"./loadSts-CMF7UdVc.js";import{C as E,g as I,s as l}from"./index-D09fRpTy.js";import{a as ue}from"./index-D09fRpTy.js";import"./index-CBKTp7rt.js";import"./toUtf8.browser-CyauOOnS.js";function y(){return async()=>"us-east-1"}class x extends E.classBuilder().ep(R).m(function(t,o,s,n){return[I(s,t.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").sc(S).build(){}const $=e=>{if(typeof e?.Arn=="string"){const t=e.Arn.split(":");if(t.length>4&&t[4]!=="")return t[4]}},T=async(e,t,o,s={})=>{const n=typeof e=="function"?await e():e,a=typeof t=="function"?await t():t;let i="";const r=n??a??(i=await y()());return o?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${n} (credential provider clientConfig)`,`${a} (contextual client)`,`${i} (STS default: AWS_REGION, profile region, or us-east-1)`),r},W=(e,t)=>{let o;return async s=>{if(!o){const{logger:d=e?.parentClientConfig?.logger,profile:u=e?.parentClientConfig?.profile,region:m,requestHandler:c=e?.parentClientConfig?.requestHandler,credentialProviderLogger:p,userAgentAppId:g=e?.parentClientConfig?.userAgentAppId}=e,f=await T(m,e?.parentClientConfig?.region,p,{}),C=!P(c);o=new t({...e,userAgentAppId:g,profile:u,region:f,requestHandler:C?c:void 0,logger:d})}const{Credentials:n,AssumedRoleUser:a}=await o.send(new x(s));if(!n||!n.AccessKeyId||!n.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${s.RoleArn}`);const i=$(a),r={accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,sessionToken:n.SessionToken,expiration:n.Expiration,...n.CredentialScope&&{credentialScope:n.CredentialScope},...i&&{accountId:i}};return i&&l(r,"RESOLVED_ACCOUNT_ID","T"),l(r,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),r}},P=e=>e?.metadata?.handlerProtocol==="h2",D=(e,t)=>t?class extends e{constructor(s){super(s);for(const n of t)this.middlewareStack.use(n)}}:e,q=(e={},t)=>W(e,D(A,t));export{E as $Command,_ as AssumeRole$,H as AssumeRoleCommand,M as AssumeRoleRequest$,U as AssumeRoleResponse$,S as AssumeRoleWithWebIdentity$,x as AssumeRoleWithWebIdentityCommand,j as AssumeRoleWithWebIdentityRequest$,N as AssumeRoleWithWebIdentityResponse$,z as AssumedRoleUser$,B as Credentials$,F as ExpiredTokenException,V as ExpiredTokenException$,G as IDPCommunicationErrorException,J as IDPCommunicationErrorException$,Q as IDPRejectedClaimException,X as IDPRejectedClaimException$,Y as InvalidIdentityTokenException,Z as InvalidIdentityTokenException$,O as MalformedPolicyDocumentException,ee as MalformedPolicyDocumentException$,te as PackedPolicyTooLargeException,ne as PackedPolicyTooLargeException$,oe as PolicyDescriptorType$,se as ProvidedContext$,ie as RegionDisabledException,re as RegionDisabledException$,A as STSClient,ae as STSServiceException,ce as STSServiceException$,le as Tag$,ue as __Client,q as getDefaultRoleAssumerWithWebIdentity};
